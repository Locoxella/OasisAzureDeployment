images:
  oasis:
    platform:
      image: ${ACR}/coreoasis/api_server
      imagePullPolicy: Always
    worker_controller:
      image: ${ACR}/coreoasis/worker_controller
      imagePullPolicy: Always

ingress:
  uiHostname: ${DOMAIN}

  tls:
    strategy: 'letsencrypt'
    certificateSecret: oasis-ingress-tls
    email: ${LETSENCRYPT_EMAIL}

oasisServer:
  oidc:
    endpoint: https://${DOMAIN}/auth/realms/oasis/protocol/openid-connect/

affinity:
  # Place all pods on nodes with label oasislmf/node-type set to either 'platform'
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: oasislmf/node-type
              operator: In
              values:
                - platform


ingress-nginx:
  controller:
    nodeSelector:
      oasislmf/node-type: platform

    service:
      annotations:
        service.beta.kubernetes.io/azure-dns-label-name: ${DNS_LABEL_NAME}

      # Make nginx log the real client IP
      externalTrafficPolicy: Local


azure:
  host: {}
  storageAccounts:
    oasisfs:
      secretName: oasis-storage-account
      accountName: account  # Replaced by Azure Deployment
      accountKey: key       # Replaced by Azure Deployment

# Volumes to mount and use within the platform
volumes:
  host: null
  azureFiles:
    sharedFs:
      csi:
        driver: file.csi.azure.com
        volumeAttributes:
          secretName: oasis-storage-account
          shareName: oasisfs
#          mountOptions: "dir_mode=0777,file_mode=0777,cache=strict,actimeo=30"
