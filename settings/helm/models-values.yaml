modelVolumes:
  - name: oasis-models-azure-file
    source: azureFiles
    csi:
      driver: file.csi.azure.com
      volumeAttributes:
        secretName: oasis-storage-account
        shareName: models

workers:
  - supplierId: OasisLMF
    modelId: PiWind
    modelVersionId: "1"
    image: ${ACR}/coreoasis/model_worker
    version: dev
    imagePullPolicy: Always
    env: # Additional worker environment variables
      - name: OASIS_DEBUG
        value: "1"
      - name: OASIS_MODEL_DATA_DIRECTORY
        value: /home/worker/model
    volumes: # Volume defined in modelVolumes
      - name: oasis-models-azure-file
        type: model-data
        mountPath: /home/worker/model
        source: azureFiles

registration_job:
  nodeSelector:
    oasislmf/node-type: platform

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: oasislmf/node-type
              operator: In
              values:
                - worker
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: oasislmf/type
              operator: In
              values:
                - worker
        topologyKey: "kubernetes.io/hostname"
